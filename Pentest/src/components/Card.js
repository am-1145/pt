// Card.js
import React, { useEffect, useState } from 'react';
import { useNavigate } from 'react-router-dom'; // Import useNavigate for navigation
import './Card.css';

function App() {
  const [cart, setCart] = useState([]);
  const [notificationVisible, setNotificationVisible] = useState(false);
  const navigate = useNavigate(); // Initialize useNavigate

  const products = [
    { title: 'White Kurta Set', price: 1999, image: 'https://images.unsplash.com/photo-1667665970118-f55705003914?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8a3VydGl8ZW58MHx8MHx8fDA%3D' },
    { title: 'Lavender Kurta', price: 5999, image: 'https://www.libas.in/cdn/shop/files/lavender-printed-cotton-a-line-kurta-with-dupatta-libas-1.jpg?v=1725559563&width=1080' },
    { title: 'Green Kurta Set', price: 2565, image: 'https://www.rangriti.com/dw/image/v2/BKQK_PRD/on/demandware.static/-/Sites-rangriti-product-catalog/default/dweb8b863c/images/aw23/evrydyessnls18897aw23sagegrn_1.jpg?sw=502&sh=753' },
    { title: 'Ruffle Gown', price: 999, image: 'https://encrypted-tbn2.gstatic.com/shopping?q=tbn:ANd9GcS8JCf9U78PfuU5mTSF1uMYvozit_0ageAV_jUr8hDj3bmYTmflFnSAM2S24KgrBosOx3OLNCWnPW8qgFO3V81zwuj2AzvsyhTv_p-7Ctc' },
    { title: 'Wedding Gown', price: 2199, image: 'https://encrypted-tbn2.gstatic.com/shopping?q=tbn:ANd9GcSjMBs4G7HDM5oLwiLHjYS2SDUIIN0ZZ-HSvVm8IkT-3TZ3HKXFv4_2F4_rDFKkQ3j_t5Jb034gul2IqMguMlMwIv4pwksahtk_OJmpEU_RpNdzoP-20htt' },
    { title: 'Party Gown', price: 7899, image: 'https://images.meesho.com/images/products/436759404/2lu5h_1200.jpg' },
    { title: 'Casual Tee', price: 999, image: 'https://source.unsplash.com/random/300x300/?casual,tee' },
    { title: 'Crop Top', price: 2199, image: 'https://source.unsplash.com/random/300x300/?crop,top' },
    { title: 'Peplum Top', price: 7899, image: 'https://source.unsplash.com/random/300x300/?peplum,top' },
  ];

  // Load cart from localStorage on component mount
  useEffect(() => {
    const storedCart = localStorage.getItem('cart');
    if (storedCart) {
      setCart(JSON.parse(storedCart));
    }
  }, []);

  const addToCart = (product) => {
    const existingProduct = cart.find((item) => item.title === product.title);

    if (existingProduct) {
      const updatedCart = cart.map((item) =>
        item.title === product.title ? { ...item, quantity: item.quantity + 1 } : item
      );
      setCart(updatedCart);
      localStorage.setItem('cart', JSON.stringify(updatedCart));
    } else {
      const updatedCart = [...cart, { ...product, quantity: 1 }];
      setCart(updatedCart);
      localStorage.setItem('cart', JSON.stringify(updatedCart));
    }
    showNotification();
  };

  const showNotification = () => {
    setNotificationVisible(true);
    setTimeout(() => {
      setNotificationVisible(false);
    }, 2000);
  };

  // Navigate to Cart page with cart items
  const goToCart = () => {
    navigate('/cart', { state: { cart } });
  };

  return (
    <div>
      <section className="hero">
        <div className="hero-content">
          <h2>Discover Your Perfect Style</h2>
          <a href="#shop" className="btn-primary">Shop Now</a>
        </div>
      </section>

      <section id="shop" className="container">
        <h2 className="section-heading">Featured Products</h2>
        <div className="product-grid">
          {products.map((product, index) => (
            <div className="product-card" key={index}>
              <img src={product.image} alt={product.title} className="product-image" />
              <div className="product-info">
                <h3 className="product-title">{product.title}</h3>
                <p className="product-price">â‚¹{product.price}</p>
                <button onClick={() => addToCart(product)} className="add-to-cart">Add to Cart</button>
              </div>
            </div>
          ))}
        </div>
      </section>

      {notificationVisible && <div className="notification">Product added to cart!</div>}

      {/* Button to navigate to Cart Page */}
      <button onClick={goToCart} className="btn-primary">View Cart</button>

      <footer>
        <div className="container">
          <p>&copy; 2024 AMEHA Clothing. All rights reserved.</p>
        </div>
      </footer>
    </div>
  );
}

export default App;
